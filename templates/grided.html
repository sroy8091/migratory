<!DOCTYPE html>
<html>
  <head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
        <link rel="stylesheet" type="text/css" href="map.css">
	 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
      #panel {
        position: absolute;
        top: 5px;
        left: 50%;
        margin-left: -180px;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
      }
    </style>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?key=AIzaSyCbLDaUFsoSUH9Dx4R9eDVovC9Ldsky_UQ&sensor=false&v=3&libraries=geometry"></script>
    <script>
        var map;

var qtrArray = [];
var linesArray = [];
var Startlatlng;
var llOffset = 2.5000000;

var drawGridBox = false;
var gridline;
var polylinesquare;
var latPolylines = [];
var lngPolylines = [];
var bounds = new google.maps.LatLngBounds();
var temp = [];
var citymap;
var circles = [];
var showOpacity = 0.3;
      var hideOpacity = 0.0;
$.getJSON( "temp.json", function( data ) {
 	temp = data;
});
$.getJSON( "sider.json", function( ata ) {
 	citymap = ata;
	console.log(citymap);
});
function initialize() {
  map = new google.maps.Map(document.getElementById('map-canvas'), {
    center: new google.maps.LatLng(22.5937,78.9629),
    zoom: 5,
    streetViewControl: true, 
    scaleControl: true,
    styles: [
  {
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#f5f5f5"
      }
    ]
  },
  {
    "elementType": "labels",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "elementType": "labels.icon",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#616161"
      }
    ]
  },
  {
    "elementType": "labels.text.stroke",
    "stylers": [
      {
        "color": "#f5f5f5"
      }
    ]
  },
  {
    "featureType": "administrative.country",
    "elementType": "geometry.stroke",
    "stylers": [
      {
        "color": "#000b0d"
      },
      {
        "weight": 1
      }
    ]
  },
  {
    "featureType": "administrative.land_parcel",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#bdbdbd"
      }
    ]
  },
  {
    "featureType": "administrative.neighborhood",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "administrative.province",
    "elementType": "geometry.stroke",
    "stylers": [
      {
        "color": "#a6be9e"
      },
      {
        "weight": 1
      }
    ]
  },
  {
    "featureType": "poi",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#eeeeee"
      }
    ]
  },
  {
    "featureType": "poi",
    "elementType": "labels.text",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "poi",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#757575"
      }
    ]
  },
  {
    "featureType": "poi.business",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "poi.park",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#e5e5e5"
      }
    ]
  },
  {
    "featureType": "poi.park",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#9e9e9e"
      }
    ]
  },
  {
    "featureType": "road",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "road",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#ffffff"
      }
    ]
  },
  {
    "featureType": "road",
    "elementType": "labels.icon",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "road.arterial",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#757575"
      }
    ]
  },
  {
    "featureType": "road.highway",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#dadada"
      }
    ]
  },
  {
    "featureType": "road.highway",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#616161"
      }
    ]
  },
  {
    "featureType": "road.local",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#9e9e9e"
      }
    ]
  },
  {
    "featureType": "transit",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "transit.line",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#e5e5e5"
      }
    ]
  },
  {
    "featureType": "transit.station",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#eeeeee"
      }
    ]
  },
  {
    "featureType": "water",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#c9c9c9"
      }
    ]
  },
  {
    "featureType": "water",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#9e9e9e"
      }
    ]
  }
]

  });


  google.maps.event.addListener(map, 'bounds_changed', function() {
    createGridLines(map.getBounds());
  });
	function rectcolor(x){
		value = Math.floor(x);
		value = (value - 269)*10;
		return value;
	}

	var k = 0;
	var l = 0;
	for(i=0;i!=37.5;i+=2.5){
		
	  var colr = 'rgb('+rectcolor(temp[l]).toString()+',0,'+(255-rectcolor(temp[l])).toString()+')';
	  var rectangle = new google.maps.Rectangle({
          strokeColor: colr,
          strokeOpacity: 0.2,
          strokeWeight: 1,
          fillColor: colr,
          fillOpacity: 0.5,
          map: map,
          bounds: {
            north: 40-k,
            south: 37.5-k,
            east: 67.5+i,
            west: 65+i
          }
        });
	l+=1;
	if(i==35&k!=35){
		i=-2.5;
		k+=2.5;
	}
}
		var cityCircle;
		for (var city in citymap) {
		  cityCircle = new google.maps.Circle({
		    strokeColor: '#8612C9',
		    strokeOpacity: 0.0,
		    strokeWeight: 2,
		    fillColor: '#8612C9',
		    fillOpacity: 0.8,
		    map: map,
		    center: {lat:citymap[city].latitude, lng:citymap[city].longitude},
		    radius: 20000,
                    day_no: citymap[city].day_no,
                    month_name: citymap[city].month_name,
                    year: citymap[city].year,
                    show: true
		  });

		    circles.push(cityCircle);
		   
		}

}

google.maps.event.addDomListener(window, 'load', initialize);

/*
function createGridLines(bounds) {
  // remove any existing lines from the map
  for (var i = 0; i < latPolylines.length; i++) {
    latPolylines[i].setMap(null);
  }
  latPolylines = [];
  for (var i = 0; i < lngPolylines.length; i++) {
    lngPolylines[i].setMap(null);
  }
  lngPolylines = [];
  // don't add the lines if the boxes are too small to be useful
  if (map.getZoom() <= 1) return;
  var north = bounds.getNorthEast().lat();
  var east = bounds.getNorthEast().lng();
  var south = bounds.getSouthWest().lat();
  var west = bounds.getSouthWest().lng();

  // define the size of the grid
  var topLat = Math.ceil(north / llOffset) * llOffset;
  var rightLong = Math.ceil(east / llOffset) * llOffset;

  var bottomLat = Math.floor(south / llOffset) * llOffset;
  var leftLong = Math.floor(west / llOffset) * llOffset;

  for (var latitude = bottomLat; latitude <= topLat; latitude += llOffset) {
    // lines of latitude
    latPolylines.push(new google.maps.Polyline({
      path: [
        new google.maps.LatLng(latitude, leftLong),
        new google.maps.LatLng(latitude, rightLong)
      ],
      map: map,
      geodesic: true,
      strokeColor: '#0000FF',
      strokeOpacity: 0.3,
      strokeWeight: 1
    }));
  }
  for (var longitude = leftLong; longitude <= rightLong; longitude += llOffset) {
    // lines of longitude
    lngPolylines.push(new google.maps.Polyline({
      path: [
        new google.maps.LatLng(topLat, longitude),
        new google.maps.LatLng(bottomLat, longitude)
      ],
      map: map,
      geodesic: true,
      strokeColor: '#0000FF',
      strokeOpacity: 0.5,
      strokeWeight: 1
    }));
  }
}*/
	function showByMonth(month_name) {
	     circles.forEach(function(c){
		if(c.month_name==month_name)
		    c.setOptions({fillOpacity:showOpacity});
	     });
	}

	function hideByMonth(month_name) {
	     circles.forEach(function(c){
		if(c.month_name!=month_name)
		    c.setOptions({fillOpacity:hideOpacity});
	     });
	}

	function filterByMonth(month_name) {
	     circles.forEach(function(c){
		if(c.month_name==month_name)
		    c.setOptions({fillOpacity:showOpacity});
		else
		    c.setOptions({fillOpacity:hideOpacity});
	     });
	}

	function showAll() {
	     circles.forEach(function(c){
		 c.setOptions({fillOpacity:showOpacity});
	     });
	}
    </script>
  </head>
  <body>
	<div id="floating-panel">
      <button onclick="filterByMonth('Jan')">Jan</button>
      <button onclick="filterByMonth('Feb')">Feb</button>
      <button onclick="filterByMonth('Mar')">March</button>
      <button onclick="showAll()">All</button>
    </div>
    <div id="map-canvas"></div>
    
  </body>
</html>
