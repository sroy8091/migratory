{% extends 'base.html' %}
{% load staticfiles %}
{% block extrahead %}
    <style type="text/css">
      #custom {
          visibility: hidden;
      }
  </style>

    <style>#map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
              html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #floating-panel {
        position: absolute;
        top: 17%;
        left: 70%;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
        border-radius: 15px;
        text-align: center;
        font-family: 'Roboto','sans-serif';
        line-height: 30px;
        padding-left: 10px;
      }

      #floating-header {
        position: absolute;
        top: 60%;
        left: 67.5%;
        background-color: #fff;
        border: 0.25px solid #999;
        border-radius: 15px;
        z-index: 5;
        padding: 5px;
        text-align: center;
        font-family: 'Roboto','sans-serif';
        line-height: 30px;
        padding-left: 10px;
      }
        .text {
              margin: 5px 5px;
              padding: 1px;
              width: 230px;
           }

        .t50 {
            width: 100px;
        }

        .button {
            padding: 0px 15px;
            margin: 5px 0px;
        }

        .button:hover {
            padding: 4px 18px;
            background: linear-gradient(rgba(0,0,0,0.4),rgba(0,0,0,0.7),rgba(0,0,0,0.4));
            color: white;
            border-radius: 10px;
            font-weight: bolder;
            border: 1px black solid;

        }
        .fl_h{
            margin: 5px 10px;
            color:#8612C9;
            width: 300px;
        }
    </style>
{% endblock %}
{% block extrascripts %}

<script>
      // This example creates circles on the map, representing populations in North
      // America.

      // First, create an object containing LatLng and population for each city.

      var circles = [];
      var showOpacity = 0.3;
      var hideOpacity = 0.0;
      var map;

      function initMap() {
		 map = new google.maps.Map(document.getElementById('map'), {
		  zoom: 5,
		  center: {lat: 22.5937, lng: 78.9629},
		  styles: [
              {
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#f5f5f5"
                  }
                ]
              },
              {
                "elementType": "labels",
                "stylers": [
                  {
                    "visibility": "off"
                  }
                ]
              },
              {
                "elementType": "labels.icon",
                "stylers": [
                  {
                    "visibility": "off"
                  }
                ]
              },
              {
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#616161"
                  }
                ]
              },
              {
                "elementType": "labels.text.stroke",
                "stylers": [
                  {
                    "color": "#f5f5f5"
                  }
                ]
              },
              {
                "featureType": "administrative.country",
                "elementType": "geometry.stroke",
                "stylers": [
                  {
                    "color": "#bec8ca"
                  },
                  {
                    "weight": 1.5
                  }
                ]
              },
              {
                "featureType": "administrative.land_parcel",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#bdbdbd"
                  }
                ]
              },
              {
                "featureType": "administrative.neighborhood",
                "stylers": [
                  {
                    "visibility": "off"
                  }
                ]
              },
              {
                "featureType": "administrative.province",
                "elementType": "geometry.stroke",
                "stylers": [
                  {
                    "color": "#a6be9e"
                  },
                  {
                    "weight": 1
                  }
                ]
              },
              {
                "featureType": "poi",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#eeeeee"
                  }
                ]
              },
              {
                "featureType": "poi",
                "elementType": "labels.text",
                "stylers": [
                  {
                    "visibility": "off"
                  }
                ]
              },
              {
                "featureType": "poi",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#757575"
                  }
                ]
              },
              {
                "featureType": "poi.business",
                "stylers": [
                  {
                    "visibility": "off"
                  }
                ]
              },
              {
                "featureType": "poi.park",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#e5e5e5"
                  }
                ]
              },
              {
                "featureType": "poi.park",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#9e9e9e"
                  }
                ]
              },
              {
                "featureType": "road",
                "stylers": [
                  {
                    "visibility": "off"
                  }
                ]
              },
              {
                "featureType": "road",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#ffffff"
                  }
                ]
              },
              {
                "featureType": "road",
                "elementType": "labels.icon",
                "stylers": [
                  {
                    "visibility": "off"
                  }
                ]
              },
              {
                "featureType": "road.arterial",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#757575"
                  }
                ]
              },
              {
                "featureType": "road.highway",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#dadada"
                  }
                ]
              },
              {
                "featureType": "road.highway",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#616161"
                  }
                ]
              },
              {
                "featureType": "road.local",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#9e9e9e"
                  }
                ]
              },
              {
                "featureType": "transit",
                "stylers": [
                  {
                    "visibility": "off"
                  }
                ]
              },
              {
                "featureType": "transit.line",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#e5e5e5"
                  }
                ]
              },
              {
                "featureType": "transit.station",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#eeeeee"
                  }
                ]
              },
              {
                "featureType": "water",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#c9c9c9"
                  }
                ]
              },
              {
                "featureType": "water",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#9e9e9e"
                  }
                ]
              }
            ]

		});
    }


	var circles = [];

	function repopulate(jsonloc){
            circles.forEach(function(c){
                    c.setMap(null);
	     });
            jsonloc = JSON.parse(jsonloc);
            circles = [];
        console.log("repo len="+jsonloc.length);
		var circle;
		for (var loc in jsonloc) {
		    circle = new google.maps.Circle({
		    strokeColor: '#8612C9',
		    strokeOpacity: 0.0,
		    strokeWeight: 2,
		    fillColor: '#8612C9',
		    fillOpacity: showOpacity,
		    map: map,
		    center: {lat:jsonloc[loc]["fields"]["lat"], lng:jsonloc[loc]["fields"]["lng"]},
		    radius: 20000//*jsonloc[loc].fields.cnt
		  });
            //console.log(circle["center"]);
		    circles.push(circle);
            //console.log(circles.length)
		}

	}



    </script>

    <script>$( function() {
            $( "#datepicker1, #datepicker2").datepicker({
              changeMonth: true,
              changeYear: true
            });
       } );</script>
	<script defer async
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCbLDaUFsoSUH9Dx4R9eDVovC9Ldsky_UQ&callback=initMap">
    </script>

    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
      <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
      <!--<script type="text/javascript" src="http://www.bdcc.co.uk/Gmaps/v3_ll_grat.js"></script>-->
      <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
        <script>$( function() {
            $( "#datepicker1, #datepicker2").datepicker({
              changeMonth: true,
              changeYear: true
            });
       } );</script>
	{#  <script defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCbLDaUFsoSUH9Dx4R9eDVovC9Ldsky_UQ&callback=initMap"></script> #}
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/resources/demos/style.css">
    <script>
  $( function() {
    $( "#id_start_date" ).datepicker();
    $( "#id_end_date" ).datepicker();
  } );
  </script>
    <script type="text/javascript">
      function f1() {
          document.getElementById("custom").style.visibility = "hidden";
      }

     function f2() {
          document.getElementById("custom").style.visibility = "visible";
      }
  </script>
{% endblock %}
{% block content %}
	<div class="container">
	    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
	        <div class="left_nav col-lg-2 col-md-2 col-sm-2 col-xs-2">
                <div class="filter_header col-lg-12 col-md-12 col-sm-12 col-xs-12" style="font-size: 18px; color: white; text-align: center; padding: 5px; background-color: rgb(0,0,0,1);">
                    FILTER
                </div>
                <div class="filters col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <h4>Filter by Duration</h4><br>
                    <a class="links" id="year" data-id="12">Last Year<br>
                    <a href="#" id="smonth" name="date" data-id="13">Last 6 Months<br>
                    <a href="#" id="month" data-id="14">Month<br>
{#                    <input type="radio" name="date" value="14" onclick="f2()"><span class="links">Custom Interval</span><br>#}
                    <div id="custom">
                        <span>Start Date: </span><br>
                        <input type="date" class="date" name="s_date"><br>
                        <span>End Date: </span><br>
                        <input type="date" class="date" name="e_date">
                        <br><br>
                        <input type="submit" name="filter1" class="submit">
                    </div>
                    <br><br>
                </div>
                <div class="filters col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <h4>Filter by Surface Air Temperature @ 925hp</h4><br>
                    <input type="radio" name="temp" value="21" checked><span class="links">All</span>
                    <input type="radio" name="temp" value="22"><span class="links">< 0&deg; C</span>
                    <input type="radio" name="temp" value="23"><span class="links">> 0&deg; C</span><br>
                    <br>
                    <span>Low & High Temp (in &deg; C): </span><br>
                    <input type="text" class="date" name="s_date" style="width: 50px;"> to
                    <input type="text" class="date" name="e_date" style="width: 50px;">
                    <br><br>
                    <input type="submit" name="filter2" class="submit">
                </div>

            </div>
	        <div class="main_div col-lg-8 col-md-8 col-sm-8 col-xs-8">
{#                <iframe width="100%" height="100%" src="/visualize"></iframe>#}

                <div id="floating-header">
                  <h4 class="fl_h">Recorded Bird Observations in India</h4>
                </div>
                <div id="map"></div>
	        </div>
	        <div class="right_nav col-lg-2 col-md-2 col-sm-2 col-xs-2">
	        	<div class="filter_header col-lg-12 col-md-12 col-sm-12 col-xs-12" style="font-size: 18px; color: white; text-align: center; padding: 5px; background-color: rgb(0,0,0,1);">
	        		SPECIES
	        	</div>
	        	<div class="filters col-lg-12 col-md-12 col-sm-12 col-xs-12">
    				<h4>Select a Species</h4>
                    <br>
    				<a href="" style="color: white; font-size: 1.2em; padding: 15px 0px;"><img src="{% static 'img/flamingo.jpg' %}" class="simg"><span class="sname" id="sname1">Greater Flamingo</span></a><br>
    				<a href="" style="color: white; font-size: 1.2em; padding: 15px 0px;"><img src="{% static 'img/peacock.jpg' %}" class="simg"><span class="sname" id="sname2">Indian Peafowl</span></a><br>
    				<a href="" style="color: white; font-size: 1.2em; padding: 15px 0px;"><img src="{% static 'img/bluethroat.jpg' %}" class="simg" ><span class="sname" id="sname3">Bluethrouat</span></a><br>
    				<a href="" style="color: white; font-size: 1.2em; padding: 15px 0px;"><img src="{% static 'img/kingfisher.jpg' %}" class="simg" ><span class="sname" id="sname4">Common Kingfisher</span></a><br>
{#                    <a id="submit_btn" href="#" data-id="12">Json</a>#}
{#                    <p id="reg">j</p>#}
	        	</div>
	        </div>
	    </div>
	</div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src=" http://cdn.jsdelivr.net/jquery.cookie/1.4.1/jquery.cookie.min.js "></script>
<script>
  var csrftoken = $.cookie('csrftoken');
  function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
  }
  $.ajaxSetup({
    beforeSend: function(xhr, settings) {
      if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
        xhr.setRequestHeader("X-CSRFToken", csrftoken);
      }
    }
  });
  $(document).ready(function(){
  $('#smonth').click(function(e){
    e.preventDefault();
    $.get('/data/filter/',
      {
        id: $(this).data('id'),
{#        action: $(this).data('action')#}
      },
      function(data){
        if (data['status'] == 'ok')
        {
            var d = data['j'];
          $("#reg").html(d);
        }
        else{
            $("#reg").html("There's an error");
    }
      }
    );
    });

  $('#year').click(function(e){
    e.preventDefault();
    $.get('/data/filter/',
      {
        id: $(this).data('id'),
{#        action: $(this).data('action')#}
      },
      function(data){
        if (data['status'] == 'ok')
        {
            var d = data['j'];
          $("#reg").html(d);
        }
        else{
            $("#reg").html("There's an error");
    }
      }
    );
    });

  $('#month').click(function(e){
    e.preventDefault();
    $.get('/data/filter/',
      {
        id: $(this).data('id'),
{#        action: $(this).data('action')#}
      },
      function(data){
        if (data['status'] == 'ok')
        {
            var d = data['j'];
            repopulate(d);
          $("#reg").html(d);
        }
        else{
            $("#reg").html("There's an error");
    }
      }
    );
    });
   });
</script>
{% endblock %}
